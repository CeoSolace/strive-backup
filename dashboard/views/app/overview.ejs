<%- include("../partials/topbar") %>

<div class="container mx-auto px-6 py-8">

  <!-- ⚠️ PRODUCTION WARNING -->
  <div style="
    background: #ff4d4f;
    color: white;
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 25px;
    font-weight: 600;
    text-align: center;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  ">
    ⚠️ WARNING: This dashboard is nowhere near fully production finished.
    Expect bugs, missing features, and incomplete functionality.
  </div>

  <!-- Page Title -->
  <div class="flex items-center justify-between mb-6">
    <div>
      <h1 class="text-3xl font-bold text-gray-800 dark:text-white">
        Dashboard Overview
      </h1>
      <p class="text-gray-500 dark:text-gray-400 mt-1">
        Welcome back, <%= user ? (user.username || user.global_name || "User") : "User" %>
      </p>
    </div>
  </div>

  <!-- Info Cards -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">

    <!-- Discord Account -->
    <div class="bg-white dark:bg-gray-800 shadow rounded-lg p-6">
      <h2 class="text-lg font-semibold text-gray-700 dark:text-white mb-3">
        Discord Account
      </h2>

      <% if (user) { %>
        <div class="flex items-center space-x-4">
          <img 
            src="https://cdn.discordapp.com/avatars/<%= user.id %>/<%= user.avatar %>.png?size=128"
            alt="Avatar"
            class="w-16 h-16 rounded-full"
          />
          <div>
            <p class="font-bold text-gray-800 dark:text-white">
              <%= user.username %>
            </p>
            <p class="text-gray-500 dark:text-gray-400 text-sm">
              ID: <%= user.id %>
            </p>
          </div>
        </div>
      <% } else { %>
        <p class="text-gray-500">No user session detected.</p>
      <% } %>
    </div>

    <!-- Bot Status -->
    <div class="bg-white dark:bg-gray-800 shadow rounded-lg p-6">
      <h2 class="text-lg font-semibold text-gray-700 dark:text-white mb-3">
        Bot Status
      </h2>

      <p class="text-green-500 font-semibold">
        ● Online
      </p>

      <% if (client) { %>
        <p class="text-gray-500 dark:text-gray-400 text-sm mt-2">
          Guilds: <%= client.guilds ? client.guilds.cache.size : "N/A" %>
        </p>
        <p class="text-gray-500 dark:text-gray-400 text-sm">
          Uptime: <%= client.uptime ? Math.floor(client.uptime / 60000) + " minutes" : "N/A" %>
        </p>
      <% } %>
    </div>

    <!-- Quick Links -->
    <div class="bg-white dark:bg-gray-800 shadow rounded-lg p-6">
      <h2 class="text-lg font-semibold text-gray-700 dark:text-white mb-3">
        Quick Links
      </h2>

      <div class="space-y-3">

        <!-- Invite Bot -->
        <a 
          href="https://discord.com/api/oauth2/authorize?client_id=1457843538401300480&scope=bot+applications.commands&permissions=8"
          target="_blank"
          class="block w-full text-center bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded"
        >
          Invite Bot
        </a>

        <!-- Support Server -->
        <a 
          href="<%= client && client.config ? client.config.SUPPORT_SERVER : '#' %>"
          target="_blank"
          class="block w-full text-center bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2 px-4 rounded"
        >
          Support Server
        </a>

      </div>
    </div>

  </div>

  <!-- Guilds Section -->
  <div class="bg-white dark:bg-gray-800 shadow rounded-lg p-6">
    <h2 class="text-lg font-semibold text-gray-700 dark:text-white mb-4">
      Your Servers
    </h2>

    <% if (user && user.guilds && user.guilds.length > 0) { %>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">

        <% user.guilds.forEach(guild => { %>
          <div class="border rounded-lg p-4 flex items-center justify-between">
            <div>
              <p class="font-semibold text-gray-800 dark:text-white">
                <%= guild.name %>
              </p>
              <p class="text-xs text-gray-500">
                ID: <%= guild.id %>
              </p>
            </div>

            <a 
              href="/app?guild=<%= guild.id %>"
              class="bg-indigo-600 hover:bg-indigo-700 text-white text-sm px-3 py-1 rounded"
            >
              Manage
            </a>
          </div>
        <% }) %>

      </div>
    <% } else { %>
      <p class="text-gray-500">
        You are not currently managing any servers.
      </p>
    <% } %>
  </div>

</div>

<%- include("../partials/sidebar") %>
